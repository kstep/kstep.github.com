function _crm(){function a(){return x+=1,d.set("eventsCount",x),x}function b(a){a=a||u.event;var b=new n(t,a.currentTarget||a.srcElement);s.send(b),t.extendSession()}function c(a){var c,d;for(c=0,d=a.length;d>c;c++)A(a[c],"click",b)}function d(){function a(a,b,c){"undefined"==typeof b&&(c=-999999999,b=""),c=c||9999999999;var d=new Date;d.setTime(d.getTime()+1e3*c);var e="; expires="+d.toGMTString();v.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+e+"; path=/"}function b(a){var b=v.cookie.split("; ");a=encodeURIComponent(a);for(var c=0,d=b.length;d>c;c++){var e=b[c].split("=",2);if(e[0]==a)return decodeURIComponent(e[1])}}var c=this;c.set=function(b,c,d){a(b,c,d)},c.get=function(a){return b(a)}}function e(a){function b(a){return"/report"}function c(a){return a.toMessage?a.toMessage():JSON.stringify(a)}var d=this;d.baseUrl=a;var e;if(u.XMLHttpRequest&&"withCredentials"in new u.XMLHttpRequest)e=u.XMLHttpRequest;else{if(!u.XDomainRequest)throw new Error("CORS request API missing");e=u.XDomainRequest}d.send=function(a,f){f=f||"";var g=new e;g.open("POST",d.baseUrl+f+b(a),!0),g.setRequestHeader&&g.setRequestHeader("Content-Type","application/json; charset=utf-8"),g.send(c(a))}}function f(){return JSON.stringify(this)}function g(a){return a?a.split("/")[2].replace("www.",""):null}function h(a){if(!a)return{};var b,c,d=/\+/g,e=/([^&=]+)=?([^&]*)/g,f=function(a){return decodeURIComponent(a.replace(d," "))},g=a.split("?")[1]||"";for(b={};c=e.exec(g);)b[f(c[1])]=f(c[2]);return b}function i(){var a=h(u.referrer),b=d.get("crm_campaign"),c={};if(b)try{c=JSON.parse(b)}catch(e){if(!(e instanceof SyntaxError))throw e;z.log("ignoring crm campaign data from storage")}var f={source:a.utm_source||c.source||void 0,name:a.utm_campaign||c.name||void 0,content:a.utm_content||c.content||void 0,term:a.utm_term||c.term||void 0,medium:a.utm_medium||c.medium||void 0};return d.set("crm_campaign",JSON.stringify(f)),f}function j(b,c){function d(){return"undefined"==typeof u.orientation?"desktop":"mobile"}function e(){return-1!=w.appVersion.indexOf("Android")?"android":-1!=w.appVersion.indexOf("Win")?"windows":-1!=w.appVersion.indexOf("Mac")?"mac":-1!=w.appVersion.indexOf("Linux")||-1!=w.userAgent.indexOf("Linux")?"linux":-1!=w.appVersion.indexOf("X11")?"unix":void 0}function f(){var a=w.userAgent.toLowerCase();return-1!=a.indexOf("opera/")||-1!=a.indexOf("opr/")?"Opera":-1!=a.indexOf("seamonkey/")?"Seamonkey":-1!=a.indexOf("firefox/")?"Firefox":-1!=a.indexOf("chrome/")?"Chrome":-1!=a.indexOf(";msie ")?"MSIE":-1!=a.indexOf("android")?"Android":void 0}if(!b)throw new Error("argument 'report_type' is required");var i=h(u.location.search),j=h(u.referrer),k={report_type:b,site:c.site,site_version:c.site_version,js_version:q,client_timestamp:(new Date).getTime(),client_timezone:c.timezone,user_id:c.user_id,custom_login_id:c.custom_login_id||void 0,session_id:c.session_id,event_count:a(),browser:f(),device_type:d(),os:e(),user_agent:w.userAgent,site_type:c.site_type,page_url:u.location.href,page_path:u.location.pathname,page_qs:JSON.stringify(i),referrer_url:u.referrer||void 0,referrer_domain:g(u.referrer)||void 0,referrer_qs:JSON.stringify(j)||void 0,campaign_source:c.campaign.source||void 0,campaign_id:c.campaign.name||void 0,ad_id:c.campaign.content||void 0,ad_click_id:j.gclid||void 0,campaign_medium:c.campaign.medium||void 0,campaign_term:c.campaign.term||void 0,source:void 0,event_category:void 0,event:void 0,optional_params:void 0,optional_params_type:void 0};return k}function k(a,b,c,e,f){function g(){var a=new Date,b=-a.getTimezoneOffset(),c=function(a){return 10>a?"0"+a:""+a},d=c(Math.abs(Math.floor(b/60))),e=c(Math.abs(b%60)),f=0>b?"-":"+";return f+d+":"+e}function h(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}if(!a)throw new Error("argument 'site' is required");if(!b)throw new Error("argument 'siteVersion' is required");if(!f)throw new Error("argument 'sessionExpires_sec' is required");var j=this,k=!1;j.site=a,j.site_version=b,j.site_type=c,j.timezone=g(),j.user_id=d.get("crm_userId"),j.user_id||(j.user_id=h(),d.set("crm_userId",j.user_id)),j.custom_login_id=e||d.get("crm_customLoginId"),d.set("crm_customLoginId",j.custom_login_id),j.session_id=d.get("crm_sessionId"),j.session_id||(j.session_id=h(),d.set("crm_sessionId",j.session_id,f),k=!0),j.extendSession=function(){d.set("crm_sessionId",j.session_id,f)},j.setCustomLoginId=function(a){j.custom_login_id=a,d.set("crm_customLoginId",a)},j.isNewSession=function(){return k},j.campaign=i()}function l(a){if(!a)throw new Error("argument 'identity' is required");var b=this;b.identity=a,b.getPath=function(){return"/session"}}function m(a){if(!a)throw new Error("argument 'identity' is required");var b=this;b.identity=a,b.getPath=function(){return"/page_view"}}function n(a,b){if(!a)throw new Error("argument 'identity' is required");if(!b)throw new Error("argument 'element' is required");var c=this;switch(c.identity=a,b.tagName.toLowerCase()){case"button":case"input":c.source="button";break;case"a":c.source="link";break;case"img":c.source="photo";break;default:c.source="custom"}c.element={id:b.getAttribute("id"),"class":b.getAttribute("class"),title:b.getAttribute("title"),alt:b.getAttribute("alt"),text:b.innerText}}function o(a,b,c,d,e){if(!a)throw new Error("argument 'identity' is required");if(!b)throw new Error("argument 'eventType' is required");if(!c)throw new Error("argument 'category' is required");var f=this;d=d||{},f.identity=a,f.event={event_type:b,category:c,params:d,options:e},f.getPath=function(){return"/event"}}function p(a,b){if(!a)throw new Error("argument 'identity' is required");if(!b)throw new Error("argument 'profile' is required");var c=this;c.identity=a,c.profile=b,c.getPath=function(){return"/user_profile"}}var q="1.0",r=this,d=new d,s=void 0,t=void 0,u=window,v=u.document,w=u.navigator,x=parseInt(d.get("eventsCount"),10)||0,y=!0,z=u.console||{log:function(){},warn:function(){},error:function(){}};r.init=function(a){if(!a)throw new Error("options argument was not provided");if(!a.site)throw new Error("option 'site' is required");if(!a.siteVersion)throw new Error("option 'siteVersion' is required");if(!a.url)throw new Error("option 'url' is required");if(a.sessionExpires_sec=a.sessionExpires_sec||5400,a.siteType=a.siteType||"desktop",y="undefined"==typeof a.autoEvents?!0:!!a.autoEvents,s=new e(a.url),t=new k(a.site,a.siteVersion,a.siteType,a.customLoginId,a.sessionExpires_sec),t.isNewSession()){x=0;var b=new l(t);s.send(b)}if(y){s.send(new m(t));try{c(v.getElementsByTagName("a"))}catch(d){z.warn("Could not handle link clicks",d)}try{c(v.getElementsByTagName("button"))}catch(d){z.warn("Could not handle button clicks",d)}try{c(v.getElementsByTagName("img"))}catch(d){z.warn("Could not handle img clicks",d)}try{c(v.querySelectorAll("input[type=submit], input[type=button]"))}catch(d){z.warn("Could not handle input clicks",d)}}a.callback&&a.callback()},r.setCustomLoginId=function(a){if("undefined"==typeof a)throw new Error("argument 'id' is required");t.setCustomLoginId(a||void 0)},r.trackEvent=function(a,b,c,d){var e=new o(t,a,b,c,d);s.send(e),t.extendSession()},r.trackEvents=function(a){for(var b=0,c=a;c>b;b++){var d=a[b];r.trackEvent(d.type,d.category,d.params,d.options)}},r.runQueue=function(a){var b,c,d,e;for(d=0,e=a.length;e>d;d++)c=a[d],c instanceof Array&&(b=c.shift(),"_"!==b.charAt(0)&&r[b]instanceof Function&&r[b].apply(r,c))},r.userProfile=function(a){var b=new p(t,a);s.send(b),t.extendSession()},r._jsonpCallback=function(a){};var A=v.addEventListener?function(a,b,c){a.addEventListener(b,c)}:function(a,b,c){a.attachEvent("on"+b,c)};k.prototype.toMessage=f,l.prototype.toMessage=function(){var a=j("autogenerated",this.identity);return a.event_category="session",a.event="session_created",a.source="activity",JSON.stringify(a)},m.prototype.toMessage=function(){var a=j("autogenerated",this.identity);return a.event_category="views",a.event="pageview",a.source="page",JSON.stringify(a)},n.prototype.toMessage=function(){var a,b=this,c=j("autogenerated",b.identity),d=b.element;c.source=b.source,c.event_category="clicks",c.event=encodeURIComponent(d.id+"_"+d["class"]+"_"+d.title+"_"+d.alt+"_"+d.text);for(a in d)c["p_element_"+a]=d[a]||void 0;return JSON.stringify(c)},o.prototype.toMessage=function(){var a=this,b=j("event_tracking",a.identity);b.event_category=a.event.category,b.event=a.event.event_type,b.source="custom";var c=a.event.params;for(var d in c)b["p_"+d]=c[d];return a.event.options&&(b.optional_params_type="event_optional_param",b.optional_params=JSON.stringify(a.event.options)),JSON.stringify(b)},p.prototype.toMessage=function(){var a=this,b=j("user_profile",a.identity);return b.event_category="user_profile",b.event="user_profile",b.source="profile",b.optional_params_type="user_profile",b.optional_params=JSON.stringify(a.profile),JSON.stringify(b)}}!function(a){a._crm=new _crm,a._crm_options&&_crm.init(a._crm_options),a._crmq&&_crm.runQueue(a._crmq),a._crmq={push:function(){var a=Array.prototype.slice.call(arguments);return _crm.runQueue(a)},concat:function(){for(var a=Array.prototype.slice.call(arguments),b=0,c=a.length;c>b;b++)return _crm.runQueue(a[b])}}}(window);